<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dashboard - NYSC</title>

    <!-- Favicons -->
    <link rel="icon" type="image/x-icon" href="favicon.ico" />
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="192x192" href="android-chrome-192x192.png" />

    <link rel="stylesheet" href="styles.css" />

    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
        /* Module Selector Styles */
        .module-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .module-card {
            background: var(--white);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .module-card:hover {
            border-color: var(--nysc-green);
            box-shadow: 0 4px 12px rgba(5, 150, 105, 0.2);
            transform: translateY(-2px);
        }

        .module-card.active {
            border-color: var(--nysc-green);
            background: linear-gradient(135deg, rgba(5, 150, 105, 0.05) 0%, rgba(5, 150, 105, 0.1) 100%);
        }

        .module-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .module-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
        }

        .module-description {
            color: var(--text-muted);
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        /* Layout Styles */
        .admin-layout {
            display: flex;
            min-height: calc(100vh - 80px);
            width: 100%;
            margin: 0;
            padding: 0;
        }

        /* Sidebar - Only for System Admin */
        .admin-sidebar {
            width: 280px;
            min-width: 280px;
            background: var(--white);
            border-right: 1px solid var(--border-color);
            padding: 1.5rem;
            position: relative;
            height: auto;
            overflow-y: auto;
            box-shadow: 2px 0 4px rgba(0, 0, 0, 0.05);
        }

        .admin-sidebar.hidden {
            display: none;
        }

        /* Hide sidebar for non-system modules */
        .admin-sidebar.module-hidden {
            display: none;
        }

        .sidebar-section {
            margin-bottom: 2rem;
        }

        .sidebar-section-title {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-muted);
            margin-bottom: 0.75rem;
            letter-spacing: 0.5px;
        }

        .sidebar-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            color: var(--text-dark);
            text-decoration: none;
            border-radius: 6px;
            transition: all 0.2s ease;
            margin-bottom: 0.25rem;
            cursor: pointer;
        }

        .sidebar-link:hover {
            background: var(--background-light);
            color: var(--nysc-green);
        }

        .sidebar-link.active {
            background: var(--nysc-green);
            color: var(--white);
        }

        .sidebar-link-icon {
            font-size: 1.25rem;
            width: 24px;
            text-align: center;
        }

        /* Workspace Styles */
        .admin-workspace {
            flex: 1;
            padding: 1.5rem 2rem;
            overflow-y: auto;
            min-height: calc(100vh - 80px);
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }

        /* Full width workspace when sidebar is hidden */
        .admin-workspace.full-width {
            width: 100%;
            max-width: 100%;
        }

        /* Contextual Action Buttons */
        .contextual-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            margin-bottom: 2rem;
            padding: 1rem;
            background: var(--background-light);
            border-radius: 8px;
        }

        .action-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.25rem;
            background: var(--white);
            color: var(--text-dark);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            text-decoration: none;
            font-size: 0.95rem;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .action-btn:hover {
            background: var(--nysc-green);
            color: var(--white);
            border-color: var(--nysc-green);
        }

        .action-btn.active {
            background: var(--nysc-green);
            color: var(--white);
            border-color: var(--nysc-green);
        }

        .action-btn-icon {
            font-size: 1.1rem;
        }

        .workspace-header {
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--border-color);
        }

        .workspace-header-top {
            display: flex;
            justify-content: flex-start;
            margin-bottom: 1rem;
        }

        .workspace-title {
            font-size: 2rem;
            font-weight: bold;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
        }

        .workspace-subtitle {
            color: var(--text-muted);
            font-size: 0.95rem;
        }

        .back-to-modules-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--background-light);
            color: var(--text-dark);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            text-decoration: none;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .back-to-modules-btn:hover {
            background: var(--nysc-green);
            color: var(--white);
            border-color: var(--nysc-green);
        }

        .logout-btn {
            background: rgba(255, 255, 255, 0.1) !important;
            border: 1px solid rgba(255, 255, 255, 0.2) !important;
        }

        .logout-btn:hover {
            background: rgba(255, 255, 255, 0.2) !important;
        }

        .workspace-content {
            display: none;
        }

        .workspace-content.active {
            display: block;
        }

        /* Back to Modules Button */
        .back-to-modules {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--background-light);
            color: var(--text-dark);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            text-decoration: none;
            margin-bottom: 1rem;
            transition: all 0.2s ease;
        }

        .back-to-modules:hover {
            background: var(--nysc-green);
            color: var(--white);
            border-color: var(--nysc-green);
        }

        /* Mobile Sidebar Toggle */
        .sidebar-toggle {
            display: none;
            position: fixed;
            left: 1rem;
            top: 90px;
            z-index: 101;
            background: var(--nysc-green);
            color: var(--white);
            border: none;
            border-radius: 6px;
            padding: 0.5rem 1rem;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 80px;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 99;
        }

        .sidebar-overlay.active {
            display: block;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .admin-layout {
                flex-direction: column;
            }

            .admin-sidebar {
                width: 100%;
                position: fixed;
                left: -100%;
                top: 80px;
                height: calc(100vh - 80px);
                transition: left 0.3s ease;
                z-index: 100;
            }

            .admin-sidebar.mobile-open {
                left: 0;
            }

            .admin-workspace {
                width: 100%;
                padding: 1rem;
            }

            .sidebar-toggle {
                display: block;
            }

            .module-selector {
                grid-template-columns: 1fr;
                padding: 1rem;
            }

            .workspace-header {
                margin-bottom: 1rem;
                padding-bottom: 0.75rem;
            }

            .workspace-title {
                font-size: 1.5rem;
            }
        }

        @media (max-width: 480px) {
            .admin-workspace {
                padding: 0.75rem;
            }

            .workspace-title {
                font-size: 1.25rem;
            }

            .module-selector {
                padding: 0.5rem;
                gap: 1rem;
            }

            .module-card {
                padding: 1.5rem;
            }
        }

        /* Remove margin-top from page in admin */
        .page.page-admin {
            margin-top: 0 !important;
        }

        /* Remove margin-top from footer */
        .footer {
            margin-top: 0 !important;
        }

        /* Wide modal styles for Add Staff */
        .swal2-wide-modal {
            width: 800px !important;
            max-width: 90vw !important;
        }

        .swal2-html-container-wide {
            padding: 1.5rem !important;
        }

        .swal2-wide-modal .swal2-input,
        .swal2-wide-modal .swal2-select {
            width: 100% !important;
            margin: 0.5rem 0 !important;
            padding: 0.75rem !important;
            font-size: 1rem !important;
        }

        .swal2-wide-modal .swal2-input:focus,
        .swal2-wide-modal .swal2-select:focus {
            border-color: var(--nysc-green) !important;
            box-shadow: 0 0 0 3px rgba(5, 150, 105, 0.1) !important;
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="navbar-container">
            <div class="navbar-brand">
                <div class="logo-container">
                    <img src="nysclogo.png" alt="NYSC Logo" class="nysc-logo" />
                    <div class="brand-text-container">
                        <span class="brand-logo">NYSC</span>
                        <span class="brand-text">Staff and Visitor Management System</span>
                    </div>
                </div>
            </div>
            <div class="navbar-links">
                <a href="index.html" class="nav-link">Home</a>
                <a href="admin.html" class="nav-link active">Admin Dashboard</a>
                <a href="verify.html" class="nav-link">Attendance</a>
                <a href="visitor.html" class="nav-link">Visitor Sign-In</a>
                <button id="adminLogoutBtn" class="nav-link logout-btn" style="display: none;">Logout</button>
            </div>
            <button class="navbar-toggle" id="navbarToggle" aria-label="Toggle navigation">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>

    <main class="page page-admin">
        <!-- Login Form -->
        <section class="card" id="loginSection">
            <h1>Admin Dashboard</h1>
            <form id="adminAuthForm" class="inline-form">
                <label class="field">
                    <span>Admin Key</span>
                    <input type="password" id="adminKey" name="adminKey" autocomplete="off" required />
                </label>
                <button type="submit" class="btn btn-primary">Unlock</button>
            </form>
            <p class="info info-muted">
                Access is logged. Keep this page secure.
            </p>
            <div id="loginStatus" class="status" style="margin-top: 1rem; display: none;"></div>
        </section>

        <!-- Module Selector (shown after login) -->
        <section id="moduleSelector" class="hidden">
            <div class="module-selector">
                <div class="module-card" data-module="attendance">
                    <div class="module-icon">üìä</div>
                    <div class="module-title">Attendance</div>
                    <div class="module-description">
                        Track staff attendance and manage devices
                    </div>
                </div>
                <div class="module-card" data-module="visitors">
                    <div class="module-icon">üë•</div>
                    <div class="module-title">Visitors</div>
                    <div class="module-description">
                        Handle visitor sign-ins and approvals
                    </div>
                </div>
                <div class="module-card" data-module="hrm">
                    <div class="module-icon">üëî</div>
                    <div class="module-title">Staff Records</div>
                    <div class="module-description">
                        Manage staff information, leaves, and documents
                    </div>
                </div>
                <div class="module-card" data-module="system" id="systemModuleCard" style="display: none;">
                    <div class="module-icon">‚öôÔ∏è</div>
                    <div class="module-title">System Settings</div>
                    <div class="module-description">
                        Manage formations, admins, and system configuration
                    </div>
                </div>
            </div>
        </section>

        <!-- Admin Layout with Sidebar and Workspace -->
        <div id="adminLayout" class="admin-layout hidden">
            <!-- Sidebar Toggle (Mobile Only) -->
            <button class="sidebar-toggle" id="sidebarToggle" aria-label="Toggle sidebar">
                ‚ò∞ Menu
            </button>

            <!-- Sidebar Overlay (Mobile Only) -->
            <div class="sidebar-overlay" id="sidebarOverlay"></div>

            <!-- Sidebar -->
            <aside class="admin-sidebar" id="adminSidebar">
                <a href="#" class="back-to-modules" id="backToModulesBtn">
                    ‚Üê Back to Modules
                </a>

                <!-- Module-specific sidebar content will be injected here -->
                <div id="sidebarContent"></div>
            </aside>

            <!-- Workspace -->
            <div class="admin-workspace">
                <!-- Attendance Workspace -->
                <div id="attendanceWorkspace" class="workspace-content">
                    <div class="workspace-header">
                        <div class="workspace-header-top">
                            <button class="back-to-modules-btn back-to-modules-header">
                                ‚Üê Back to Modules
                            </button>
                        </div>
                        <h1 class="workspace-title">Attendance</h1>
                        <p class="workspace-subtitle">Track staff attendance and manage devices</p>
                    </div>
                    <div class="contextual-actions" id="attendanceActions"></div>
                    <div id="attendanceContent" class="card-grid"></div>
                </div>

                <!-- Visitors Workspace -->
                <div id="visitorsWorkspace" class="workspace-content">
                    <div class="workspace-header">
                        <div class="workspace-header-top">
                            <button class="back-to-modules-btn back-to-modules-header">
                                ‚Üê Back to Modules
                            </button>
                        </div>
                        <h1 class="workspace-title">Visitors</h1>
                        <p class="workspace-subtitle">Handle visitor sign-ins and approvals</p>
                    </div>
                    <div class="contextual-actions" id="visitorsActions"></div>
                    <div id="visitorsContent" class="card-grid"></div>
                </div>

                <!-- HRM Workspace -->
                <div id="hrmWorkspace" class="workspace-content">
                    <div class="workspace-header">
                        <div class="workspace-header-top">
                            <button class="back-to-modules-btn back-to-modules-header">
                                ‚Üê Back to Modules
                            </button>
                        </div>
                        <h1 class="workspace-title">Staff Records</h1>
                        <p class="workspace-subtitle">Manage staff information, leaves, and documents</p>
                    </div>
                    <div class="contextual-actions" id="hrmActions"></div>
                    <div id="hrmContent" class="card-grid"></div>
                </div>

                <!-- System Admin Workspace -->
                <div id="systemWorkspace" class="workspace-content">
                    <div class="workspace-header">
                        <div class="workspace-header-top">
                            <button class="back-to-modules-btn back-to-modules-header">
                                ‚Üê Back to Modules
                            </button>
                        </div>
                        <h1 class="workspace-title">System Settings</h1>
                        <p class="workspace-subtitle">Manage formations, admins, and system configuration</p>
                    </div>
                    <div id="systemContent" class="card-grid"></div>
                </div>
            </div>
        </div>
    </main>

    <!-- Load scripts -->
    <script src="js/api.js"></script>
    <script src="js/ui.js"></script>
    <script>
        // Verify all modules loaded
        console.log('UI loaded:', typeof UI !== 'undefined');
        console.log('AdminPage loaded:', typeof AdminPage !== 'undefined');

        // Wait for DOM and ensure AdminPage is loaded
        window.addEventListener('DOMContentLoaded', function () {
            if (typeof AdminPage === 'undefined') {
                console.error('‚ùå AdminPage is not defined. Check ui.js for syntax errors.');
                alert('Error: AdminPage is not loaded.\n\nPlease check browser console for details.');
                return;
            }

            try {
                console.log('Initializing AdminPage...');
                AdminPage.init();
                console.log('‚úì AdminPage initialized successfully');
            } catch (err) {
                console.error('‚ùå Error initializing AdminPage:', err);
                alert('Error initializing admin page: ' + err.message);
            }
        });

        // Mobile navigation toggle
        document.getElementById('navbarToggle')?.addEventListener('click', function () {
            const navbar = document.querySelector('.navbar-links');
            navbar.classList.toggle('active');
        });
    </script>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-content">
                <div class="footer-section">
                    <div class="footer-logo-container">
                        <img src="nysclogo.png" alt="NYSC Logo" class="footer-logo" />
                    </div>
                    <h3 class="footer-title">NYSC</h3>
                    <p class="footer-text">
                        National Youth Service Corps<br>
                        Staff and Visitor Management System
                    </p>
                </div>
                <div class="footer-section">
                    <h4 class="footer-heading">Quick Links</h4>
                    <ul class="footer-links">
                        <li><a href="index.html">Home</a></li>
                        <li><a href="admin.html">Admin Dashboard</a></li>
                        <li><a href="verify.html">Attendance</a></li>
                        <li><a href="visitor.html">Visitor Sign-In</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4 class="footer-heading">Contact</h4>
                    <ul class="footer-links">
                        <li>Plot 416, Tigris Crescent</li>
                        <li>Maitama, Abuja, Nigeria</li>
                        <li>Email: info@nysc.gov.ng</li>
                        <li>Website: <a href="https://www.nysc.gov.ng" target="_blank">www.nysc.gov.ng</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4 class="footer-heading">System Info</h4>
                    <ul class="footer-links">
                        <li>Version 1.0</li>
                        <li>Government-Grade Security</li>
                        <li>Multi-Formation Support</li>
                        <li>24/7 Availability</li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 National Youth Service Corps (NYSC). All rights reserved.</p>
                <div class="footer-social">
                    <a href="https://www.nysc.gov.ng" target="_blank" aria-label="NYSC Website">Official Website</a>
                </div>
            </div>
        </div>
    </footer>
</body>
</html>